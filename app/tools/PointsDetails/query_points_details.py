from datetime import datetime
from typing import Annotated
from langchain_core.tools import tool


@tool
def query_points_details(
        card_no: Annotated[str, "卡号"],
        bank_code: Annotated[str, "银行号"],
        start_date: Annotated[str, "查询开始日期，格式：YYYY-MM-DD"],
        end_date: Annotated[str, "查询结束日期，格式：YYYY-MM-DD"]
) -> str:
    """根据卡号、银行号以及时间范围查询用户的积分明细"""

    # 转换日期格式为 datetime 对象
    try:
        start_date_obj = datetime.strptime(start_date, "%Y-%m-%d")
        end_date_obj = datetime.strptime(end_date, "%Y-%m-%d")
    except ValueError:
        return "日期格式不正确，请使用 YYYY-MM-DD 格式。"

    points_logs= """序号 积分池类型 积分科目编号 积分科目名称 积分记录卡号 交易卡号 积分变动值 积分余额 积分有效期起 积分有效期止 交易类型 交易描述 交易日期 交易时间 活动名称 交易金额 商户名称 
1 电子礼券 S00000000101220250213 【邮储总行】2025年蜜雪冰城周周享-3月奖励 1262********5000 1262********9800 -4 0   20250331 积分到期 到期失效 20250401 153657   0.00   2 电子礼券 S00000000101220250213 【邮储总行】2025年蜜雪冰城周周享-3月奖励 1340********7966 1340********8100 -14 0   20250331 积分到期 到期失效 20250401 122057   0.00   3 电子礼券 S00000000101220250213 【邮储总行】2025年蜜雪冰城周周享-3月奖励 1340********7966 1340********8100 1 0   20250331 新增 财付通(银联云闪付) 20250327 193758 【邮储总行】2025年蜜雪冰城周周享-3月 0.00   4 电子礼券 S00000000101220250213 【邮储总行】2025年蜜雪冰城周周享-3月奖励 1262********5000 1262********9800 1 0   20250331 新增 中国电信股份有限公司四川分公司 20250326 183906 【邮储总行】2025年蜜雪冰城周周享-3月 0.00   5 电子礼券 S00000000101220250213 【邮储总行】2025年蜜雪冰城周周享-3月奖励 1340********7966 1259********7900 6 13   20250331 退货 权益撤销 20250325 160001   0.00 11113227923448094720 6 电子礼券 S00000000101220250213 【邮储总行】2025年蜜雪冰城周周享-3月奖励 1340********7966 1259********7900 -6 7   20250331 兑换 蜜雪冰城5元券（周周享）二期，共1件 20250325 093002   0.00 1111224651184472065 7 电子礼券 S00000000101220250213 【邮储总行】2025年蜜雪冰城周周享-3月奖励 1340********7966 1340********8100 1 0   20250331 新增 财付通(银联云闪付) 20250325 005647 【邮储总行】2025年蜜雪冰城周周享-3月 0.00   8 电子礼券 S00000000101220250213 【邮储总行】2025年蜜雪冰城周周享-3月奖励 1340********7966 1259********7900 6 12   20250331 退货 权益撤销 20250324 142154   0.00 11109357146877460480 9 电子礼券 S00000000101220250213 【邮储总行】2025年蜜雪冰城周周享-3月奖励 1340********7966 1259********7900 -6 6   20250331 兑换 蜜雪冰城5元券（周周享）二期，共1件 20250324 093025   0.00 1110862358122741760 10 电子礼券 S00000000101220250213 【邮储总行】2025年蜜雪冰城周周享-3月奖励 1340********7966 1259********7900 6 12   20250331 退货 权益撤销 20250323 222643   0.00 11106953327082414090 11 电子礼券 S00000000101220250213 【邮储总行】2025年蜜雪冰城周周享-3月奖励 1340********8100 1259********7900 -6 6   20250331 兑换 蜜雪冰城5元券（周周享）二期，共1件 20250323 212949   0.00 1110681014189051904 12 电子礼券 S00000000101220250213 【邮储总行】2025年蜜雪冰城周周享-3月奖励 1340********8100 1259********7900 6 12   20250331 退货 权益撤销 20250323 162202   0.00 11106035578302750720 13 电子礼券 S00000000101220250213 【邮储总行】2025年蜜雪冰城周周享-3月奖励 1340********8100 1259********7900 -6 6   20250331 兑换 蜜雪冰城5元券（周周享）二期，共1件 20250323 153302   0.00 1110591226287108097 14 电子礼券 S00000000101220250213 【邮储总行】2025年蜜雪冰城周周享-3月奖励 1262********9800 1262********9800 1 0   20250331 新增 中国电信股份有限公司四川分公司 20250323 132907 【邮储总行】2025年蜜雪冰城周周享-3月 0.00   15 电子礼券 S00000000101220250213 【邮储总行】2025年蜜雪冰城周周享-3月奖励 1340********8100 1259********7900 6 12   20250331 退货 权益撤销 20250323 093104   0.00 11105001338265927690 16 电子礼券 S00000000101220250213 【邮储总行】2025年蜜雪冰城周周享-3月奖励 1340********8100 1259********7900 -6 6   20250331 兑换 蜜雪冰城5元券（周周享）二期，共1件 20250323 093003   0.00 1110499881744723968 17 电子礼券 S00000000101220250213 【邮储总行】2025年蜜雪冰城周周享-3月奖励 1262********9800 1262********9800 1 0   20250331 新增 中国电信股份有限公司四川分公司 20250321 131739 【邮储总行】2025年蜜雪冰城周周享-3月 0.00   18 电子礼券 S00000000101220250213 【邮储总行】2025年蜜雪冰城周周享-3月奖励 1340********8100 1340********8100 1 0   20250331 新增 财付通(银联云闪付) 20250320 081730 【邮储总行】2025年蜜雪冰城周周享-3月 0.00   19 电子礼券 S00000000101220250213 【邮储总行】2025年蜜雪冰城周周享-3月奖励 1340********8100 1340********8100 1 0   20250331 新增 中移动金融科技有限公司 20250312 101446 【邮储总行】2025年蜜雪冰城周周享-3月 0.00   20 电子礼券 S00000000101220250213 【邮储总行】2025年蜜雪冰城周周享-3月奖励 1340********8100 1340********8100 1 0   20250331 新增 财付通(银联云闪付) 20250311 112959 【邮储总行】2025年蜜雪冰城周周享-3月 0.00   21 电子礼券 S00000000101220250213 【邮储总行】2025年蜜雪冰城周周享-3月奖励 1340********8100 1340********8100 1 0   20250331 新增 财付通(银联云闪付) 20250310 194439 【邮储总行】2025年蜜雪冰城周周享-3月 0.00   22 电子礼券 S00000000101220250213 【邮储总行】2025年蜜雪冰城周周享-3月奖励 1340********8100 1340********8100 1 0   20250331 新增 财付通(银联云闪付) 20250309 001232 【邮储总行】2025年蜜雪冰城周周享-3月 0.00   23 电子礼券 S00000000101220250213 【邮储总行】2025年蜜雪冰城周周享-3月奖励 1340********8100 1340********8100 1 0   20250331 新增 财付通(银联云闪付) 20250308 181542 【邮储总行】2025年蜜雪冰城周周享-3月 0.00   24 电子礼券 S00000000101220250213 【邮储总行】2025年蜜雪冰城周周享-3月奖励 1262********9800 1262********9800 1 0   20250331 新增 天翼支付-天翼电子商务有限公司上海分公司 20250307 100031 【邮储总行】2025年蜜雪冰城周周享-3月 0.00   25 电子礼券 S00000000101220250213 【邮储总行】2025年蜜雪冰城周周享-3月奖励 1340********8100 1340********8100 1 0   20250331 新增 中移动金融科技有限公司 20250306 092753 【邮储总行】2025年蜜雪冰城周周享-3月 0.00   26 电子礼券 S00000000101220250213 【邮储总行】2025年蜜雪冰城周周享-3月奖励 1340********8100 1340********8100 1 0   20250331 新增 财付通(银联云闪付) 20250305 225728 【邮储总行】2025年蜜雪冰城周周享-3月 0.00   27 电子礼券 S00000000101220250213 【邮储总行】2025年蜜雪冰城周周享-3月奖励 1340********8100 1340********8100 1 0   20250331 新增 美团 20250304 165328 【邮储总行】2025年蜜雪冰城周周享-3月 0.00   28 电子礼券 S00000000101220250213 【邮储总行】2025年蜜雪冰城周周享-3月奖励 1340********8100 1340********8100 1 0   20250331 新增 财付通(银联云闪付) 20250303 231456 【邮储总行】2025年蜜雪冰城周周享-3月 0.00   29 电子礼券 S00000000101220250213 【邮储总行】2025年蜜雪冰城周周享-3月奖励 1340********8100 1340********8100 1 0   20250331 新增 财付通(银联云闪付) 20250302 205526 【邮储总行】2025年蜜雪冰城周周享-3月 0.00   30 电子礼券 S00000000101220250213 【邮储总行】2025年蜜雪冰城周周享-3月奖励 1340********8100 1340********8100 1 0   20250331 新增 财付通(银联云闪付) 20250301 223127 【邮储总行】2025年蜜雪冰城周周享-3月 0.00"""
    return f"{bank_code}银行的用户卡号{card_no},在 {start_date_obj} 到 {end_date_obj}积分明细{points_logs}"
